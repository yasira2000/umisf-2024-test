<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <style>
        /* Add custom styles if needed */
        body {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
      </style>
  </head>
  <body>
    <section class="hero is-primary is-bold">
      <div class="hero-body">
        <div class="container">
          <h1 style="text-align: center;" class="title">Age Group Registration Form</h1>
        </div>
      </div>
    </section>
    <form id="form" class="container m-4 pl-4" method="POST" action="https://script.google.com/macros/s/AKfycbxgq44qk4XMmH-6m9SUDspmXMcv_31OQtdL-euvpOmJeTnmiXVHA_NuhQJInn5pTqKC/exec">
      <div class="field">
        <label class="label">Name of Applicant</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Your Name"
            name="Name"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">School of Applicant</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Your School"
            name="School"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Date of Birth</label>
        <div class="control">
          <input
            class="input"
            type="date"
            placeholder="Date of Birth"
            name="DOB"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Contact Number(Whatsapp Number)</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Your Contact Number"
            name="ContactNumber"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Email</label>
        <div class="control">
          <input
            class="input"
            type="email"
            placeholder="Your Email"
            name="Email"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Participating Event</label>
        <div class="control">
          <select class="input"
          type="text"
          placeholder="Participating Event"
          name="ParticipatingEvent">
            <option value="Single">Single</option>
            <option value="Double">Double</option>
            <option value="Single & Double">Single & Double</option>
          </select>
        </div>
      </div>

      <div class="field">
        <label class="label">Age Category</label>
        <div class="control">
          <select class="input"
          type="text"
          placeholder="Age Category"
          name="AgeCategory">
            <option value="U9-Boys">U9-Boys</option>
            <option value="U9-Girls">U9-Girls</option>
            <option value="U11-Boys">U11-Boys</option>
            <option value="U11-Girls">U11-Girls</option>
            <option value="U13-Boys">U13-Boys</option>
            <option value="U13-Girls">U13-Girls</option>
            <option value="U15-Boys">U15-Boys</option>
            <option value="U15-Girls">U15-Girls</option>
          </select>
        </div>
      </div>

      <h2>This Section is only for double players</h2>
      
      <div class="field">
        <label class="label">Double Partners Name</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Your Double Partners Name"
            name="DoublePartner"
            value="None"
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Past Performance</label>
        <p>Please indicate your past yearâ€™s best performances and if participated, performance in our past
          tournaments, (UMiSF)
          If past performances are not indicated the committee is not responsible for any issues regarding the
          draws.</p>
        <div class="control">
          <textarea
            class="textarea"
            placeholder="Past Performance"
            name="PastPerformance"
          ></textarea>
        </div>
      </div>
      
      <h2>Payment Details</h2>

      <div class="field">
        <label class="label">Payement Date</label>
        <div class="control">
          <input
            class="input"
            type="date"
            placeholder="Payment Date"
            name="PaymentDate"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Paid Amount in LKR</label>
        <div class="control">
          <input
            class="input"
            type="number"
            placeholder="Paid Amount in LKR"
            name="PaidAmount"
            required           
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Payment Slip</label>
        <div class="control"> 
          <input class="input" type="file" name="file" id="files" accept="image/*" onchange="LoadFile(event)" required/>
          <input type="hidden" id="fileData" name="fileData" />
          <input type="hidden" id="mimeType" name="mimeType" />
          <input type="hidden" id="fileName" name="fileName" /></td>
          
        </div>
      </div>
      

      <!-- <div class="field">
        <label class="label">Password</label>
        <div class="control">
          <input
            class="input"
            type="password"
            placeholder="Your Password"
            name="Password"
          />
        </div>
      </div> -->


      <!-- <div class="field">
        <label class="label">Gender</label>
        <div class="control">
          <label class="radio">
            <input type="radio" name="Gender" value="male" /> Male
          </label>
          <label class="radio">
            <input type="radio" name="Gender" value="female" /> Female
          </label>
        </div>
      </div> -->

      <!-- <div class="field">
        <label class="label">Agree to Terms</label>
        <div class="control">
          <label class="checkbox">
            <input type="checkbox" name="Agree To Terms" value="yes" /> I agree
            to the terms and conditions
          </label>
        </div>
      </div> -->

      <!-- <div class="field">
        <label class="label">Additional Information</label>
        <div class="control">
          <textarea
            class="textarea"
            placeholder="Any additional information"
            name="Notes"
          ></textarea>
        </div>
      </div> -->

      <div class="field is-grouped">
        <div class="control">
          <button class="button is-primary" type="submit" id="submit-button">
            Submit
          </button>
        </div>
        <div class="control">
          <button class="button is-danger">Cancel</button>
        </div>
      </div>
    </form>

    <div
      id="message"
      style="
        display: none;
        margin: 20px;
        font-weight: bold;
        color: green;
        padding: 8px;
        background-color: beige;
        border-radius: 4px;
        border-color: aquamarine;
      "
    ></div>

    <script>

      // function getFiles() {
      //   const f = document.getElementById('files');
      //   [...f.files].forEach((file, i) => {
      //     const fr = new FileReader();
      //     fr.onload = (e) => {
      //       const data = e.target.result.split(",");
      //       const obj = {fileName: f.files[i].name, mimeType: data[0].match(/:(\w.+);/)[1], data: data[1]};
      //       google.script.run.withSuccessHandler((id) => {
      //         console.log(id);
      //       }).saveFile(obj);
      //     }
      //     fr.readAsDataURL(file);
      //   });
      // }

      function LoadFile(event)
        {
          console.log('inside the LoadFile');

          var file = event.target.files[0];
          var reader = new FileReader();
          reader.onload = function(e) {
            console.log(e.target.result);
            var fileData = e.target.result.substr(e.target.result.indexOf(",")+1);
            var mimeTypeStart = e.target.result.indexOf("data:") + 5;
            var mimeTypeEnd = e.target.result.indexOf(";");
            var mimeType = e.target.result.substr(mimeTypeStart, mimeTypeEnd - mimeTypeStart);
            var fileName = file.name;
            document.getElementById("fileData").value = fileData;
            document.getElementById("mimeType").value = mimeType;
            document.getElementById("fileName").value = fileName;

            console.log('inside onload');
          };    

          console.log('outside onload');
          reader.readAsDataURL(file);
        }


      // document.getElementById("form").addEventListener("submit", function (e) {
      //   e.preventDefault(); // Prevent the default form submission
      //   document.getElementById("message").textContent = "Submitting..";
      //   document.getElementById("message").style.display = "block";
      //   document.getElementById("submit-button").disabled = true;

      //   // Collect the form data
      //   var formData = new FormData(this);
      //   var keyValuePairs = [];
      //   for (var pair of formData.entries()) {
      //     keyValuePairs.push(pair[0] + "=" + pair[1]);
      //   }

      //   var formDataString = keyValuePairs.join("&");

      //   // Send a POST request to your Google Apps Script
      //   fetch(
      //     "https://script.google.com/macros/s/AKfycbxgq44qk4XMmH-6m9SUDspmXMcv_31OQtdL-euvpOmJeTnmiXVHA_NuhQJInn5pTqKC/exec",
      //     {
      //       redirect: "follow",
      //       method: "POST",
      //       body: formDataString,
      //       headers: {
      //         "Content-Type": "text/plain;charset=utf-8",
      //       },
      //     }
      //   )
      //     .then(function (response) {
      //       // Check if the request was successful
      //       if (response) {
      //         return response; // Assuming your script returns JSON response
      //       } else {
      //         throw new Error("Failed to submit the form.");
      //       }
      //     })
      //     .then(function (data) {
      //       // Display a success message
      //       document.getElementById("message").textContent =
      //         "Data submitted successfully!";
      //       document.getElementById("message").style.display = "block";
      //       document.getElementById("message").style.backgroundColor = "green";
      //       document.getElementById("message").style.color = "beige";
      //       document.getElementById("submit-button").disabled = false;
      //       document.getElementById("form").reset();

      //       setTimeout(function () {
      //         document.getElementById("message").textContent = "";
      //         document.getElementById("message").style.display = "none";
      //       }, 2600);
      //     })
      //     .catch(function (error) {
      //       // Handle errors, you can display an error message here
      //       console.error(error);
      //       document.getElementById("message").textContent =
      //         "An error occurred while submitting the form.";
      //       document.getElementById("message").style.display = "block";
      //     });
      // });

    </script>
  </body>
</html>


<!-- link to website

https://tanaikech.github.io/2018/12/22/uploading-multiple-files-from-local-to-google-drive-using-google-apps-script/ -->
